<section class="related-post-wrap">
{% assign maxRelated = 5 %}
{% assign minCommonTags = 1 %}
{% assign maxRelatedCounter = 0 %}
  <h4>관련 포스트</h4>
  <ul>
  {% for item in doc_items %}
  
  {% for post in item.posts %}
  {% assign sameTagCount = 0 %}
      {% for tag in post.tags %}
      {% if post.url != page.url %}{% if page.tags contains tag %}
          {% assign sameTagCount = sameTagCount | plus: 1 %}
      {% endif %}{% endif %}
      {% endfor %}

      {% if sameTagCount >= minCommonTags %}
      <li>
        <a href="{{ post.url }}">{{ post.description }}</a>
      </li>
        {% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
        {% if maxRelatedCounter >= maxRelated %}
          {% break %}
        {% endif %}
      {% endif %}
    {% endfor %}

    {% if maxRelatedCounter >= maxRelated %}
      {% break %}
    {% endif %}

  {% endfor %}
  </ul>
</section>